name = "openfront-discord-bot"
main = "src/worker.ts"
compatibility_date = "2026-01-18"

# Environment variables are set via:
# wrangler secret put DISCORD_TOKEN
# wrangler secret put DISCORD_PUBLIC_KEY
# wrangler secret put DISCORD_CLIENT_ID

# KV namespace for posted games tracking (has native TTL support)
# Create with: wrangler kv namespace create DATA
kv_namespaces = [
  { binding = "DATA", id = "e20449398e34450cb82b29c34628a401" }
]

# D1 database for guild configuration
# Create with: wrangler d1 create openfront-bot-db
[[d1_databases]]
binding = "DB"
database_name = "openfront-bot-db"
database_id = "dc44eb75-0c1f-4720-8225-1f7aab20cb31"
migrations_dir = "migrations"

# Scheduled tasks:
# - Every 5 minutes (at :00,:05,:10…): Check for clan wins
# - Every 5 minutes offset by 2 min (at :02,:07,:12…): Check for FFA wins
# - Every minute: Process scan jobs
[triggers]
crons = ["*/5 * * * *", "2-57/5 * * * *"]

[observability]
[observability.logs]
enabled = true
invocation_logs = true
